ğŸ”§ ä½¿ç”¨è¯´æ˜
1. ç”Ÿæˆ RSA å…¬ç§é’¥å¯¹

æœåŠ¡ç«¯ç”Ÿæˆå¯†é’¥ï¼š

openssl genpkey -algorithm RSA -out server_private.pem -pkeyopt rsa_keygen_bits:1024
openssl rsa -pubout -in server_private.pem -out server_public.pem

å®¢æˆ·ç«¯ç”Ÿæˆå¯†é’¥ï¼š

openssl genpkey -algorithm RSA -out client_private.pem -pkeyopt rsa_keygen_bits:1024
openssl rsa -pubout -in client_private.pem -out client_public.pem

2. å®‰è£…ä¾èµ–

ä½¿ç”¨ pip å®‰è£…é¡¹ç›®æ‰€éœ€ä¾èµ–ï¼š

pip install -r requirements.txt

3. é…ç½®å¯ä¿¡å…¬é’¥å“ˆå¸Œ

æ‰“å¼€ client.py æ–‡ä»¶ï¼Œé…ç½®æœåŠ¡ç«¯å…¬é’¥çš„ SHA-256 å“ˆå¸Œï¼š

trusted_pubkey_sha256 = "YOUR_SERVER_PUBKEY_HASH"

è·å–å…¬é’¥å“ˆå¸Œç¤ºä¾‹å‘½ä»¤ï¼š

openssl rsa -pubin -in server_public.pem -outform DER | openssl dgst -sha256

å°†è¾“å‡ºçš„å“ˆå¸Œå€¼ï¼ˆå»æ‰ (stdin)= ï¼‰ç²˜è´´åˆ°ä»£ç ä¸­ã€‚
4. å¯åŠ¨æœåŠ¡å™¨

python server.py [host] [port]

    é»˜è®¤ host ä¸º localhost
    é»˜è®¤ port ä¸º 8443

5. å¯åŠ¨å®¢æˆ·ç«¯

python client.py [host] [port]

    é»˜è®¤è¿æ¥åˆ° localhost:8443

ğŸ“¡ æŠ“åŒ…åˆ†æï¼ˆå¯é€‰ï¼‰

ä½ å¯ä»¥ä½¿ç”¨ Wireshark æŠ“åŒ…åˆ†æ TLS é€šä¿¡è¿‡ç¨‹ï¼š

    é€‰æ‹© Adapter for loopback traffic capture é€‚é…å™¨ï¼ˆæœ¬åœ°é€šä¿¡ï¼‰

    è®¾ç½®è¿‡æ»¤å™¨ä¸ºï¼š

    tcp.port == 8443

    å¯ä»¥è§‚å¯Ÿï¼š
        æ¡æ‰‹è¿‡ç¨‹ä¸­çš„ ClientHelloã€ServerHelloã€è¯ä¹¦ä¼ è¾“ç­‰æ¶ˆæ¯
        åŠ å¯†æ•°æ®ä¼ è¾“é˜¶æ®µçš„ TCP åŒ…
        HMAC æ ¡éªŒå­—æ®µ

    æ³¨æ„ï¼šç”±äºæ˜¯æœ¬åœ°å›ç¯é€šä¿¡ï¼Œå¿…é¡»ä½¿ç”¨ Npcap æ”¯æŒçš„ Loopback é€‚é…å™¨æ‰èƒ½æŠ“åŒ…æˆåŠŸã€‚

ğŸ“ é¡¹ç›®ç»“æ„

.
â”œâ”€â”€ client.py                 # å®¢æˆ·ç«¯ä¸»ç¨‹åº
â”œâ”€â”€ server.py                 # æœåŠ¡ç«¯ä¸»ç¨‹åº
â”œâ”€â”€ crypto.py                 # åŠ è§£å¯†ä¸ç­¾åå‡½æ•°
â”œâ”€â”€ common.py                 # é€šç”¨æ¶ˆæ¯å°è£…ä¸ç±»å‹å®šä¹‰
â”œâ”€â”€ client_messages.py        # å®¢æˆ·ç«¯ç›¸å…³æ¶ˆæ¯ç»“æ„
â”œâ”€â”€ server_messages.py        # æœåŠ¡ç«¯ç›¸å…³æ¶ˆæ¯ç»“æ„
â”œâ”€â”€ client_private.pem        # å®¢æˆ·ç«¯ç§é’¥ï¼ˆéœ€è‡ªè¡Œç”Ÿæˆï¼‰
â”œâ”€â”€ client_public.pem         # å®¢æˆ·ç«¯å…¬é’¥ï¼ˆéœ€è‡ªè¡Œç”Ÿæˆï¼‰
â”œâ”€â”€ server_private.pem        # æœåŠ¡ç«¯ç§é’¥ï¼ˆéœ€è‡ªè¡Œç”Ÿæˆï¼‰
â”œâ”€â”€ server_public.pem         # æœåŠ¡ç«¯å…¬é’¥ï¼ˆéœ€è‡ªè¡Œç”Ÿæˆï¼‰
â”œâ”€â”€ requirements.txt          # ä¾èµ–åŒ…åˆ—è¡¨
â”œâ”€â”€ .env                      #  ç¯å¢ƒå˜é‡
â””â”€â”€ ä½¿ç”¨æ–¹æ³•.txt               # ä½¿ç”¨è¯´æ˜æ–‡æ¡£
